import hashlib


def analyze_file_tool(request):
    file = request.files.get('file')
    if not file:
        return {'tool': 'malware-analyzer', 'error': 'no file provided'}
    data = file.read()
    sha256 = hashlib.sha256(data).hexdigest()
    size = len(data)
    return {
        'tool': 'malware-analyzer',
        'filename': getattr(file, 'filename', 'unknown'),
        'size': size,
        'sha256': sha256,
        'note': 'Static hash only; no malware analysis performed.'
    }
