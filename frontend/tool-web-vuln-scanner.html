<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Web Vulnerability Scanner — Removed</title>
  <link rel="stylesheet" href="assets/css/main.css?v=2" />
  <meta name="description" content="This tool has been removed from the deployment." />
  <style>
    .tool-page{max-width:980px;margin:28px auto;padding:18px}
    .muted{color:#64748b;font-size:14px}
    .gone{background:#fff;border:1px solid #f3e8ff;padding:18px;border-radius:12px}
  </style>
    <link rel="stylesheet" href="/assets/css/cyber-bg.css">
</head>
<body class="tool-page">
    <canvas id="cyber-canvas"></canvas>
  <div class="tool-page">
    <a href="/" class="plain">← Home</a>
    <header class="tool-header">
      <h1>Web Vulnerability Scanner — Removed</h1>
    </header>

    <div class="gone">
      <p class="muted">The Web Vulnerability Scanner tool was removed from this deployment for security and operational reasons. If you need similar functionality, run a dedicated scanner in your own environment or contact the project maintainers.</p>
    </div>
        <div class="item">Scan ID: <strong id="scanId">-</strong></div>
        <div class="item">Elapsed: <strong id="elapsed">0s</strong></div>
      </div>

      <div style="margin-top:14px">
        <h3>Results</h3>
        <pre id="results" class="results">No results yet.</pre>
      </div>
    </div>
  </div>

  <script>
    <script src="/assets/js/cyber-bg.js"></script>
    <script src="assets/js/main.js"></script>
    let startedAt = null;

    function setStatus(s){ document.getElementById('scanStatus').textContent = s }
    function setScanId(id){ document.getElementById('scanId').textContent = id }
    function setElapsed(){ if(!startedAt) return; const s = Math.floor((Date.now()-startedAt)/1000); document.getElementById('elapsed').textContent = s+"s" }
    function setResults(txt){ document.getElementById('results').textContent = typeof txt === 'string' ? txt : JSON.stringify(txt, null, 2) }

    async function startScan(){
      const url = document.getElementById('targetUrl').value.trim();
      if(!url) { alert('Please enter a URL'); return }
      try{
        setStatus('starting');
        const res = await fetch('/api/scan', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({url}) });
        const data = await res.json();
        if(!res.ok){ setStatus('error'); setResults(data.error || JSON.stringify(data)); return }
        const scan_id = data.scan_id;
        setScanId(scan_id);
        setStatus('running');
        startedAt = Date.now();
        setResults('Scan started — polling for results...');
        pollHandle = setInterval(async ()=>{
          setElapsed();
          try{
            const s = await fetch('/api/scan/'+encodeURIComponent(scan_id));
            const info = await s.json();
            if(info.status === 'running'){
              // still working
              return;
            }
            clearInterval(pollHandle); pollHandle = null;
            if(info.status === 'complete'){
              setStatus('complete');
              setResults(info.results || 'No findings');
            } else if(info.status === 'error'){
              setStatus('error');
              setResults(info.error || 'Unknown error');
            } else {
              setStatus(info.status || 'unknown'); setResults(info);
            }
          }catch(e){ clearInterval(pollHandle); pollHandle=null; setStatus('error'); setResults(String(e)); }
        }, 2000);
      }catch(e){ setStatus('error'); setResults(String(e)) }
    }

    document.getElementById('startBtn').addEventListener('click', startScan);
    document.getElementById('cancelBtn').addEventListener('click', ()=>{
      if(pollHandle){ clearInterval(pollHandle); pollHandle=null; setStatus('cancelled'); }
    });
  </script>
</body>
</html>
